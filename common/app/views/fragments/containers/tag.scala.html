@(page: model.MetaData, collection: model.Collection, containerLayout: layout.ContainerLayout, pagination: Option[common.Pagination] = None, dataId: String)(implicit request: RequestHeader, templateDeduping: views.support.TemplateDeduping, config: com.gu.facia.client.models.CollectionConfig)

@import model.FaciaComponentName
@import views.html.fragments.containers.facia_cards.slice
@import views.html.fragments.keywordList
@import views.support.GetClasses
@import views.support.MostPopularTags.topTags
@import dfp.DfpAgent
@import views.support.FootballTagPage

@defining(config.displayName.orElse(collection.displayName)) { title =>

    @if(collection.items.nonEmpty) {
        <section
            class="@GetClasses.forNewStyleContainer(config, false, title.nonEmpty, Seq("fc-container--first"))"
            data-link-name="@FaciaComponentName(config, collection)"
            data-id="@dataId"
            @DfpAgent.sponsorshipTag(config).map { keyword =>
                data-keywords="@keyword"
            }
            data-component="@FaciaComponentName(config, collection)">
            <div class="facia-container__inner">
                <div class="fc-container__header js-container__header">
                    @FootballTagPage(page).asOpt.map{ footballTagPage =>
                        @fragments.containers.elements.footballTeamHeader(footballTagPage, collection)
                    }.getOrElse{
                        @title.map { title =>
                            @fragments.containers.elements.tagMeta(None, collection.href, page.description, title, page.isContributorPage)
                        }
                    }
                    @fragments.contributor(page)
                </div>
                <div class="container__body container--rolled-up-hide">
                    @for(sliceWithCards <- containerLayout.slices) {
                        @slice(sliceWithCards, 0)
                    }
                </div>
                @pagination.map{ paginate => @fragments.pagination(page, paginate)}

            </div>
            <div class="facia-container__inner">
                @defining(topTags(collection.items).filterNot(_.id == page.id)) { tags =>
                    @if(tags.nonEmpty) {
                        <div class="submeta" data-link-name="keywords">
                            <h2 class="submeta__head">Trending topics</h2>
                            @keywordList(tags, 5, "See also")
                        </div>
                    }
                }
            </div>
        </section>
    }
}
